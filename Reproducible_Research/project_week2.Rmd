---
title: "Analyzing Activity Monitoring Device Data"
author: "Matteo Gambera"
output:
  html_document:
    df_print: paged
  html_notebook: default
  pdf_document: default
---

# Introduction
It is now possible to collect a large amount of data about personal movement using activity monitoring devices such as a Fitbit, Nike Fuelband, or Jawbone Up. These type of devices are part of the “quantified self” movement – a group of enthusiasts who take measurements about themselves regularly to improve their health, to find patterns in their behavior, or because they are tech geeks. But these data remain under-utilized both because the raw data are hard to obtain and there is a lack of statistical methods and software for processing and interpreting the data.

```{r}
setwd("/home/matteo/Scrivania/datasciencecoursera")
url <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
path <- paste0(getwd() , "/Reproducible_Research")
download.file(url, file.path(path, "dataFiles.zip"))
unzip(file.path(path, zipfile = "dataFiles.zip"))
```

# Data
The data for this assignment can be downloaded from the course web site: Dataset: [Activity monitoring data [52K]](https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip) The variables included in this dataset are: steps: Number of steps taking in a 5-minute interval (missing values are coded as NA) date: The date on which the measurement was taken in YYYY-MM-DD format interval: Identifier for the 5-minute interval in which measurement was taken The dataset is stored in a comma-separated-value (CSV) file and there are a total of 17,568 observations in this dataset.

```{r}
activity <- read.csv("activity.csv")
str(activity)
head(activity)
```
# Clean Data

```{r}
# problem!!! the problem ask before to do this... bha seems stupid
activity_na <- activity # build a new dataframe for this problem

n_na_step <- sum(is.na(activity$steps))
n_na_date <- sum(is.na(as.character(activity$date)))

n_na_step
n_na_date

na <- (is.na(activity$steps))
activity <- activity[!na,]
str(activity)
```

# Histogram of the total number of steps taken each day
build new dataframe to work with step aggragated

```{r}
steps_by_day <- aggregate(steps ~ date, data = activity , sum)
#Adding column names to the created data frame
colnames(steps_by_day) <- c("date", "steps")
# date is a factor, so i sum every step by days
ggplot(steps_by_day, aes(x = steps)) +
    geom_histogram(fill = "red", binwidth = 1000, color="black") +
    labs(title = "Total Steps Each Day", x = "Number of Steps", y = "Frequency")
```
# Mean and median number of steps taken each day

```{r}
mean <- mean(steps_by_day$steps)
median <- median(steps_by_day$steps)
mean 
median
ggplot(steps_by_day, aes(y = steps)) +
    geom_boxplot() +
    geom_hline(yintercept = mean, color="red", size=2) +
    geom_hline(yintercept = median, color="blue") 


```
# Time series plot of the average number of steps taken

```{r}
steps <- aggregate(activity$steps, by=list(interval=activity$interval), FUN=mean)
colnames(steps) <- c("interval", "average_steps")
max_steps <- max(steps$average_steps)
max_steps
intervale_max_steps <- steps[which.max(steps$average_steps),]$interval
intervale_max_steps

ggplot(steps, aes(x = interval , y = average_steps)) + 
        geom_line(color="red", size=1) + 
        labs(title = "Avg. Daily Steps", x = "Interval", y = "Avg. Steps per day") +
        geom_point(x = intervale_max_steps , y = max_steps , colour="blue", size = 3)

```

# The strategy for Missing values 

```{r}


```

